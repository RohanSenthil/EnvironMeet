{% extends "user_base.html" %}
{% set active_page = "search" %}
{% block title %} EnvironMeet - {{ user.username }} {% endblock %}
{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="{{ url_for('static', filename = 'styles/profile.css')}}">
<link rel="stylesheet" href="{{ url_for('static', filename = 'styles/accounts.css')}}">
{% endblock %}
{% block content %}
<div class="content">
  <div class="profile">
    <div class="backbutton">
        <a href="/search">
            <svg xmlns="http://www.w3.org/2000/svg" width="7.41" height="12" viewBox="0 0 7.41 12">
            <path id="Path_23" data-name="Path 23" d="M15.41,16.09,10.83,11.5l4.58-4.59L14,5.5l-6,6,6,6Z" transform="translate(-8 -5.5)"/>
            </svg>
        </a>
    </div>
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class='flashes'>
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} " id='alert'>
        <span>{{ message }}</span>
        <button type="button" style='float:right;'class="btn-close" aria-label="Close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
    {% if user.profile_pic %}
                <div class="profile_pic">
                    <img src="../{{ user.profile_pic }}" alt="">
                </div>
            {% else %}
                <div class="profile_pic">
                    <img src="{{ url_for('static', filename='images/default_profile_pic.png')}}" alt="">
                </div>
    {% endif %}
    <h1>{{ user.username }}</h1>
    
    <br><br>
    <div class="profile-stats">
        <ul>
            <li>
                <span class="profile-stat-count">
                {% if loggedout == False %}
                {% if not current_user.is_following(user) %}
                <button id="friend" class="btn btn-light" onclick="location.href='{{ url_for('follow', username=user.username) }}'">Follow</button>
                {% else %}
                <button id="friend" class="btn btn-light" onclick="location.href='{{ url_for('unfollow', username=user.username) }}'">Unfollow</button>
                {% endif %}

                {% elif loggedout == True %}
                <button id="friend" class="btn btn-light" onclick="location.href='{{ url_for('login_') }}'">Follow</button>
                {% endif %}
                </span>
            </li>
            <li><span class="profile-stat-count">{{ posts }}</span> posts</li>
            <li><span class="profile-stat-count">{{ followers }}</span> followers</li>
            <li><span class="profile-stat-count">{{ following }}</span> following</li>
        </ul>
    </div>
    <table>
    </table>
  </div>
</div>
<!-- Include this script in your HTML templates -->
<script>
    // Function to reset the inactivity timer
    function resetInactivityTimer() {
        fetch('/reset_activity', { method: 'POST' }); // Send a request to the server to reset the last_activity
    }

    // Add event listeners to reset the timer on user interaction
    document.addEventListener('click', resetInactivityTimer);
    document.addEventListener('keydown', resetInactivityTimer);
</script>
{% endblock%}