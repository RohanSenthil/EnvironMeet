{% extends "user_base.html" %}
{% set active_page = "events" %}
{% block title %} EnvironMeet - Events Page {% endblock %}
{% block head %}
<link rel="stylesheet" href="../../static/styles/events.css">
{% endblock %}

{% block content %}


<div class="content">
    <div class="SearchEventContainer">
        <div class="SearchEventBox" id="searchInput">
            <div class="left">
                <input class="textInput" onkeyup="search()" id="dainput" type="text" placeholder="Search">
                    </div>
            </div>
        </div>
        {% if user.is_authenticated %}
    <div class="bingchilling">
            {% if user|isinstance(memberObj) %}
        <!-- Check Attendance Button (for members) -->
            <div class="push">
                <a href="/attendance" role="button" class="egioesigseions">My Attendance</a>
            </div>
            {% endif %}

    </div>
    {% endif %}
    <div class="Guolai">
    <div class="EventsContainer1">
        {% for event in events %}
        {% if event.is_closed == False %}
        <div class="eventCard">
            {% if event.image is not none %}
            <figure class="card-image">
                <img src="/{{ event.image }}">
            </figure>
            {% endif %}
            <div class="card-header">
                <h3>{{ event.name }}</h3>
            </div>
            <div class="card-footer">
                <div class="card-meta card-meta--views">
                    <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M4.82 19.407c-2.966-1.857-4.94-5.153-4.94-8.907 0-5.795 4.705-10.5 10.5-10.5 3.605 0 6.789 1.821 8.68 4.593 2.966 1.857 4.94 5.153 4.94 8.907 0 5.795-4.705 10.5-10.5 10.5-3.599 0-6.778-1.815-8.67-4.579l-.01-.014zm8.68-15.407c5.243 0 9.5 4.257 9.5 9.5s-4.257 9.5-9.5 9.5-9.5-4.257-9.5-9.5 4.257-9.5 9.5-9.5zm.5 15h-1.021v-.871c-2.343-.302-2.599-2.179-2.599-2.744h1.091c.025.405.157 1.774 2.182 1.774.599 0 1.088-.141 1.453-.419.361-.276.536-.612.536-1.029 0-.793-.513-1.367-2.07-1.718-2.368-.536-2.923-1.398-2.923-2.533 0-1.509 1.223-2.216 2.33-2.406v-1.054h1.021v1.015c2.491.195 2.695 2.215 2.695 2.771h-1.098c0-1.161-.918-1.766-1.996-1.766-1.077 0-1.854.532-1.854 1.408 0 .781.439 1.165 1.994 1.554 1.879.473 2.999 1.101 2.999 2.681 0 1.744-1.509 2.393-2.74 2.493v.844zm2.85-15.453c-1.696-1.58-3.971-2.547-6.47-2.547-5.243 0-9.5 4.257-9.5 9.5 0 2.633 1.073 5.017 2.806 6.739l-.004-.01c-.44-1.159-.682-2.416-.682-3.729 0-5.795 4.705-10.5 10.5-10.5 1.171 0 2.298.192 3.35.547z"/></svg>
                    {% if event.price == 'Free' %}
                    {{ event.price }}
                    {% else %}
                    ${{ event.price }}
                    {% endif %}
                </div>
                <div class="card-meta card-meta--date">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" display="block" id="Calendar">
                        <rect x="2" y="4" width="20" height="18" rx="4" />
                        <path d="M8 2v4" />
                        <path d="M16 2v4" />
                        <path d="M2 10h20" />
                    </svg>
                    {{ event.date }}
                </div>
            </div>
            <a href="{{ url_for('view_event', hashedid=object_id_to_hash(event.id, act='event')) }}"></a>
        </div>

        <!-- <a href="eventsdesc.html">
        <div class="eventsCard">
            <div class="eventname">
            {{ event.name }}
                </div>
            <div class="eventimage">
                {% if event.image is not none %}
                <img src="/{{ event.image }}">
                {% endif %}
            </div>
            <p class="lavel" id="datetime">Date and Time (in 24Hrs):</p>
            {{ event.date }} </br>
            {{ event.time }}
            <p class="lavel" id="PRICE">Price:</p>{{ event.price }}
            <div class="eventorg">
            <p class="lavel" id="org">Organiser:</p><span class="lol">{{ get_user_from_id(event.organiser).name }}</span></br>
            </div> -->
            <!-- Sign up Button (for members) -->
            <!-- {# if user|isinstance(memberObj) #}
            <div class="push">
                <a href="{{ url_for('signup_events', hashedEventid=object_id_to_hash(event.id, act='event')) }}" role="button" class="egioesigseions">Sign up</a>
            </div>
            {# endif #} -->
        <!-- </div>
        </a> -->
        {% endif %}
        {% endfor %} 
    </div>
</div>
    </div>
</div>

<script src="../static/scripts/events.js"></script>
    <script>
        const searchBar = document.getElementById('searchBar');
        const eventCards = document.querySelectorAll('.eventCard');

        searchBar.addEventListener('keyup', event => {
            if (event.key === ' ') { // Check if space bar is pressed
                const searchTerm = searchBar.value.toLowerCase();

                eventCards.forEach(card => {
                    const eventName = card.querySelector('.card-header h3').textContent.toLowerCase();

                    if (eventName.includes(searchTerm)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }
        });
    </script>

{% endblock %}